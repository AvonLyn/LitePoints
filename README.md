# LitePoints 积分管理

LitePoints 是一个“打开即用”的本地积分账本：无需安装、无需联网、无需登录，仅一页文件即可记录你的得分、税收、活动与消费。它足够轻量，只有 `index.html + app.js + styles.css`，同时又足够实用——支持月/周视图统计、每日明细、类别汇总和一键编辑条目，适合长期自我管理与复盘。

## 功能概览
- 得分项、税收项、活动项三种类型，活动项可设为得分或税收
- 消费管理页：固定项与自定义项记录消费，扣分计入统计
- 左侧条目支持滚动，条目再多也不撑爆页面
- 月视图日历、周视图统计（周一至周日）
- 周视图显示得分/税收大类汇总（含活动）
- 右侧信息栏按月/周/日显示统计，并提供年/周入口
- 主页仅显示消费扣除汇总，详情在消费管理页披露
- 内置数据 + 本地自定义配置（保存在浏览器）
- 导出/导入个人备份，自动备份保留最近 3 份


## 本次更新
- 新增“消费管理”页面与入口，支持固定项/自定义项记录
- 消费扣分在主页汇总展示，详情在消费管理页披露
- 消费固定项可在管理选项中编辑
- 活动项可设置为得分或税收，统计与周汇总按方向计入
- 信息栏改为月/周/日层级展示，年/周信息独立页可展开详情
- 周视图信息栏仅展示本周统计，周详情移入周信息页
- 日记录与周大类明细采用幕布式单行列表，缩短占用空间
- 自动备份按成员保留 3 份，文件名含姓名+时间，启动时同步 `user_data/`

## 快速开始
1. 直接打开 `index.html`（离线可用）
2. 左侧选择类型 → 大类 → 条目
3. 设置倍数与日期，点击“记录本次”
4. 中间可在“月视图/周视图”间切换

## 使用指南
### 记录一条积分
- 选择得分/税收/活动
- 选择大类与条目
- 输入倍数与日期
- 点击“记录本次”

### 消费管理
- 入口：右侧信息栏的“消费管理”
- 固定项：选择大类/条目，填写倍数与日期后记录
- 自定义项：填写项目名称、积分制、倍数后记录
- 主页只显示消费扣除汇总，详情在消费管理页查看

### 视图切换
- 月视图：按月展示每天得分/税收，信息栏显示本月统计与选中日期
- 周视图：按周展示每天得分/税收，并在下方汇总得分/税收大类；信息栏仅显示本周统计
- 年/周信息：右侧信息栏入口进入独立页面查看年度范围与周明细
### 管理选项（编辑大类和条目）
- 点击左侧“管理选项”
- 选择要编辑的类型（得分/税收/活动/消费）
- 可新增/修改/删除大类与条目
- 修改会自动保存到本地浏览器

### 活动项
- 用于临时/特殊活动的加减分
- 可设置为得分或税收，并按设置计入统计
- 可在“管理选项”里自由维护

### 备份与恢复
- 顶部点击“设置备份文件夹”，建议选择项目内的 `user_data/`
- “导出备份”可手动生成备份文件
- 每次记录/编辑都会自动备份，默认每位被管理人保留 3 份，超过会覆盖最早的备份
- 备份针对当前被管理人，切换成员后可分别导出/导入
- “导入备份”会覆盖当前被管理人的记录与自定义条目
- 备份文件名包含被管理人的名字与备份时间，方便区分
- 打开页面会自动扫描 `user_data/` 同步成员与备份状态（需浏览器授权）

## 数据与存储
- 记录数据保存在浏览器 `localStorage`，清缓存会丢失（每个被管理人独立）
- 备份文件保存在你选择的备份文件夹（推荐 `user_data/`）
- `user_data/` 已加入 `.gitignore`，避免备份文件被提交
- 默认条目来自 `data/` 下的 JSON
- 一旦在“管理选项”里编辑，页面会优先使用本地自定义数据

**高级说明**
- 记录数据键：`litepoints_entries_v1__{personId}`
- 自定义条目键：`litepoints_catalog_v1__{personId}`
- 被管理人列表键：`litepoints_people_v1`

**关于 JSON 数据**
- 直接用文件方式打开时，部分浏览器可能阻止 `fetch` 读取 JSON
- 如需强制使用 `data/*.json`，建议用本地静态服务器打开目录

## 目录结构
- `index.html` 页面结构
- `styles.css` 样式
- `app.js` 核心逻辑
- `data/score_items.json` 得分项数据
- `data/tax_items.json` 税收项数据
- `data/event_items.json` 活动项数据
- `data/consume_items.json` 消费项数据
- `user_data/` 个人备份文件夹（已忽略）
- `积分管理规划表-得分项.md` 得分规划表
- `积分管理规划表-税收项.md` 税收规划表

## 常见问题
- 看不到 JSON 数据？
  可能是浏览器限制本地 `fetch`，用本地服务器打开目录即可。
- 换浏览器或清缓存后数据没了？
  数据存于本地 `localStorage`，需要手动备份或导出。
- 自动备份不生效？
  请先设置备份文件夹，并使用支持 File System Access API 的浏览器打开（推荐 Chromium 系列）。
